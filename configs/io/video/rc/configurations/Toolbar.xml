<!-- Standard video widget -->
<extension implements="sight::service::extension::AppConfig" >
    <id>sight::config::io::video::Toolbar</id>
    <parameters>
        <param name="camera" />
        <param name="frameTL" />

        <param name="TOOLBAR" />
    </parameters>
    <config>

        <object uid="${camera}" type="sight::data::Camera" src="ref" />
        <object uid="${frameTL}" type="sight::data::FrameTL" src="ref" />

        <service uid="containerView" type="sight::module::ui::base::SView" >
            <gui>
                <toolBar />
                <layout type="sight::ui::base::LineLayoutManager" >
                    <orientation value="horizontal" />
                </layout>
            </gui>
            <registry>
                <parent wid="${TOOLBAR}" />
                <toolBar sid="toolbarView" start="true" />
            </registry>
        </service>

        <service uid="videoSelectorSrv" type="sight::module::ui::qt::video::SCamera" >
            <inout key="camera" uid="${camera}" />
            <videoSupport>true</videoSupport>
        </service>

        <service uid="toolbarView" type="sight::module::ui::base::SToolBar" >
            <gui>
                <layout>
                    <editor/>
                    <menuItem name="Start" icon="sight::module::ui::flaticons/GreenStart.svg" shortcut="Space" />
                    <menuItem name="Pause" icon="sight::module::ui::flaticons/OrangePause.svg" shortcut="Space" />
                    <menuItem name="Play" icon="sight::module::ui::flaticons/GreenStart.svg" shortcut="Space" />
                    <menuItem name="Stop" icon="sight::module::ui::flaticons/RedStop.svg" />
                    <menuItem name="Loop" icon="sight::module::ui::flaticons/OrangeLoop.svg" style="check" />
                </layout>
            </gui>
            <registry>
                <editor sid="videoSelectorSrv" start="true" />
                <menuItem sid="startVideoAct" start="true" />
                <menuItem sid="pauseVideoAct" start="true" />
                <menuItem sid="resumeVideoAct" start="true" />
                <menuItem sid="stopVideoAct" start="true" />
                <menuItem sid="loopVideoAct" start="true" />
            </registry>
        </service>

        <service uid="videoGrabberSrv" type="sight::module::io::video::SGrabberProxy" >
            <in key="camera" uid="${camera}" />
            <inout key="frameTL" uid="${frameTL}" />
        </service>

        <!-- ******************************* Actions ****************************** -->

        <!-- Start the frame grabber -->
        <service uid="startVideoAct" type="sight::module::ui::base::SAction" >
            <state enabled="false" />
        </service>

        <!-- Pause the frame grabber -->
        <service uid="pauseVideoAct" type="sight::module::ui::base::SAction" >
            <state visible="false" />
        </service>

        <!-- Resume the frame grabber -->
        <service uid="resumeVideoAct" type="sight::module::ui::base::SAction" >
            <state visible="false" />
        </service>

        <!-- Stop the frame grabber -->
        <service uid="stopVideoAct" type="sight::module::ui::base::SAction" >
            <state enabled="false" />
        </service>

        <!-- Loop the frame grabber -->
        <service uid="loopVideoAct" type="sight::module::ui::base::SAction" >
            <state enabled="false" />
        </service>

        <!-- ******************************* Connections ******************************* -->

        <connect>
            <signal>startVideoAct/clicked</signal>
            <slot>videoGrabberSrv/startCamera</slot>
        </connect>

        <connect>
            <signal>pauseVideoAct/clicked</signal>
            <slot>videoGrabberSrv/pauseCamera</slot>
            <slot>resumeVideoAct/show</slot>
            <slot>pauseVideoAct/hide</slot>
        </connect>

        <connect>
            <signal>resumeVideoAct/clicked</signal>
            <slot>videoGrabberSrv/pauseCamera</slot>
            <slot>resumeVideoAct/hide</slot>
            <slot>pauseVideoAct/show</slot>
        </connect>

        <connect>
            <signal>stopVideoAct/clicked</signal>
            <slot>videoGrabberSrv/stopCamera</slot>
            <slot>startVideoAct/show</slot>
            <slot>resumeVideoAct/hide</slot>
            <slot>pauseVideoAct/hide</slot>
            <slot>stopVideoAct/disable</slot>
            <slot>loopVideoAct/disable</slot>
            <slot>loopVideoAct/uncheck</slot>
        </connect>

        <connect>
            <signal>loopVideoAct/clicked</signal>
            <slot>videoGrabberSrv/loopVideo</slot>
        </connect>

        <connect>
            <signal>videoSelectorSrv/configuredCameras</signal>
            <slot>videoGrabberSrv/reconfigure</slot>
        </connect>

        <connect>
            <signal>videoSelectorSrv/configuredFile</signal>
            <signal>videoSelectorSrv/configuredStream</signal>
            <signal>videoSelectorSrv/configuredDevice</signal>
            <slot>startVideoAct/update</slot>
        </connect>

        <connect>
            <signal>videoGrabberSrv/cameraStarted</signal>
            <slot>pauseVideoAct/show</slot>
            <slot>startVideoAct/hide</slot>
            <slot>stopVideoAct/enable</slot>
            <slot>loopVideoAct/enable</slot>
        </connect>

        <connect>
            <signal>camera/idModified</signal>
            <slot>videoGrabberSrv/stopCamera</slot>
        </connect>

        <connect>
            <signal>camera/modified</signal>
            <slot>startVideoAct/enable</slot>
            <slot>stopVideoAct/update</slot>
        </connect>

        <start uid="containerView" />
        <start uid="videoGrabberSrv" />

    </config>
</extension>
