<extension implements="::fwServices::registry::AppConfig">
    <id>splineEdition</id>
    <parameters>
        <param name="WID_PARENT" />
        <param name="GENERIC_UID" />
        <param name="SERIESDB" />
        <param name="AS_UID" />
        <param name="ICON_PATH" />
        <param name="ModelSeriesCompositeUid" />
        <param name="imageUid" />
        <param name="SplinePointListUid" />
        <param name="orientation" default="axial" />
    </parameters>
    <config>

        <object type="::fwData::Composite">

            <service uid="${GENERIC_UID}_mainView" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::CardinalLayoutManager">
                        <view caption="LeftView" align="left"/>
                        <view caption="RightView" align="right" minWidth="350" />
                    </layout>
                    <toolBar />
                </gui>
                <registry>
                    <parent wid="${WID_PARENT}" />
                    <toolBar sid="${GENERIC_UID}_toolBar" start="yes" />
                    <view sid="${GENERIC_UID}_leftView" start="yes"/>
                    <view sid="${GENERIC_UID}_rightView" start="yes" />
                </registry>
            </service>


            <service uid="${GENERIC_UID}_leftView" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_leftViewTab" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_leftViewTab" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::TabLayoutManager">
                        <view caption="Negatos" />
                        <view caption="CamView" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_view_negatos" start="yes" />
                    <view sid="${GENERIC_UID}_camView" start="yes" />
                </registry>
            </service> 

            <service uid="${GENERIC_UID}_view_negatos" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" minHeight="50"/>
                        <view proportion="1" minHeight="50"/> 
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_view_negato1" start="yes" />
                    <view sid="${GENERIC_UID}_view_negato2" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_view_negato1" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" />
                        <view proportion="0" minHeight="30" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_negato1" start="yes" />
                    <view sid="${GENERIC_UID}_slider_negato1" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_view_negato2" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" />
                        <view proportion="0" minHeight="30" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_negato2" start="yes" />
                    <view sid="${GENERIC_UID}_slider_negato2" start="yes" />
                </registry>
            </service>


            <service uid="${GENERIC_UID}_rightView" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" /> 
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_rightViewTab" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_rightViewTab" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::TabLayoutManager">
                        <view caption="SplineEditor" />
                        <view caption="TF-Negato" />
                        <view caption="Negato" />
                        <view caption="TF-Scene2D" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_SplineEditor" start="yes" />
                    <view wid="${GENERIC_UID}_view_negato" start="yes"/>
                    <view sid="${GENERIC_UID}_view_negato3" start="yes"/>
                    <view sid="${GENERIC_UID}_TFScene2D" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_view_negato3" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" />
                        <view proportion="0" minHeight="30" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_negato3" start="yes" />
                    <view sid="${GENERIC_UID}_slider_negato3" start="yes" />
                </registry>
            </service>



            <service uid="${GENERIC_UID}_SplineEditor" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" minHeight="50"/>
                        <view proportion="1" minHeight="50"/>
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_navigationEditor" start="no" />
                    <view sid="${GENERIC_UID}_splinePointsEditor" start="no" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_toolBar" type="::fwGui::IToolBarSrv" impl="::gui::aspect::SDefaultToolBar" autoConnect="no">
                <gui>
                    <layout>
                        <menuItem name="Hide cross" icon="@BUNDLE_PREFIX@/media_0-1/icons/HideCross.png" style="radio" />
                        <menuItem name="Show normal cross" icon="@BUNDLE_PREFIX@/media_0-1/icons/NormalCross.png" style="radio" />
                        <menuItem name="Show full cross" icon="@BUNDLE_PREFIX@/media_0-1/icons/FullCross.png" style="radio" />
                        <separator />
                        <menuItem name="Show 3d slice cursor" icon="@BUNDLE_PREFIX@/media_0-1/icons/icon-landmark.png" style="check" />
                        <menuItem name="Show mesh" icon="@BUNDLE_PREFIX@/media_0-1/icons/icon-3D.png" style="check" />
                        <menuItem name="Show volume rendering" icon="@BUNDLE_PREFIX@/media_0-1/icons/icon-VR.png" style="check" />
                        <menuItem name="Manage organs color" icon="@BUNDLE_PREFIX@/media_0-1/icons/ManageOrgan.png" style="check" />
                        <separator />
                        <menuItem name="Show/hide box cropping" icon="@BUNDLE_PREFIX@/media_0-1/icons/icon-box.png" style="check" />
                        <menuItem name="Reset box cropping" icon="@BUNDLE_PREFIX@/media_0-1/icons/icon-box-reset.png" />
                        <separator />
                        <menuItem name="Snapshot VR" icon="@BUNDLE_PREFIX@/media_0-1/icons/camera-photo.png" />
                        <separator />
                        <menuItem name="Export Activity" icon="@BUNDLE_PREFIX@/media_0-1/icons/Export.svg"  />
                        <spacer />
                        <menu name="View Debug" />
                    </layout>
                </gui>
                <registry>
                    <menuItem sid="${GENERIC_UID}_ActionHideCross" start="no" />
                    <menuItem sid="${GENERIC_UID}_ActionShowNormalCross" start="no" />
                    <menuItem sid="${GENERIC_UID}_ActionShowFullCross" start="no" />

                    <menuItem sid="${GENERIC_UID}_ActionShowSliceCursor" start="no" />
                    <menuItem sid="${GENERIC_UID}_ActionShowMesh" start="yes" />
                    <menuItem sid="${GENERIC_UID}_ActionShowVR" start="yes" />
                    <menuItem sid="${GENERIC_UID}_action_organManager" start="no" />

                    <menuItem sid="${GENERIC_UID}_ActionShowHideBoxWidget" start="no" />
                    <menuItem sid="${GENERIC_UID}_ActionResetBoxWidget" start="no" />

                    <menuItem sid="${GENERIC_UID}_ActionSnapshotVR" start="yes" />

                    <menuItem sid="${GENERIC_UID}_ActionExportActivity" start="yes" />
                    <menu sid="${GENERIC_UID}_menu" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_menu" type="::fwGui::IMenuSrv" impl="::gui::aspect::SDefaultMenu" autoConnect="no">
                <gui>
                    <layout>
                        <menuItem name="View Debug" style="check"/>
                    </layout>
                </gui>
                <registry>
                    <menuItem sid="${GENERIC_UID}_action_viewDebug" start="yes" />
                </registry>
            </service>

            <service uid="${GENERIC_UID}_action_viewDebug" type="::fwGui::IActionSrv" impl="::gui::action::SConfigLauncher" autoConnect="no">
                <config>
                    <appConfig id="viewDebug">
                        <parameters>
                            <parameter replace="ICON_PATH" by="${ICON_PATH}" />
                            <parameter replace="visuUid" by="${GENERIC_UID}_VisuComposite" />
                            <parameter replace="imageUid" by="${imageUid}" />
                            <parameter replace="imageKey" by="image" />
                            <parameter replace="tfSelectionsUid" by="${GENERIC_UID}_TFSelections" />
                            <parameter replace="selectedTFKey" by="SelectedTF" />
                            <parameter replace="modelSeriesKey" by="modelSeries" />
                            <parameter replace="pointListKey" by="splinePointList" />
                            <parameter replace="CurrentViewPointKey" by="CurrentViewPoint" />
                            <parameter replace="imageCursorKey" by="imageCursor" />
                            <parameter replace="selectedPointsKey" by="selectedPoints" />
                        </parameters>
                    </appConfig>
                </config>
            </service>

            <service uid="${GENERIC_UID}_TFScene2D" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" /> 
                        <view proportion="0" minHeight="30" />
                        <view proportion="0" minHeight="100" />
                        <view proportion="1" />
                        <view proportion="0" minHeight="30" />
                    </layout>
                </gui>
                <registry>
                    <view sid="${GENERIC_UID}_tfm" start="no" /> 
                    <view sid="${GENERIC_UID}_Scene2D_Shutter" start="yes" />
                    <view sid="${GENERIC_UID}_Scene2D" start="yes" />
                    <view sid="${GENERIC_UID}_FloatEditor" start="no" />
                </registry>
            </service>

            <item key="seriesDB">
                <object uid="${SERIESDB}" src="ref" type="::fwMedData::SeriesDB">
                    <service uid="${GENERIC_UID}_ActionExportActivity" type="::fwGui::IActionSrv" impl="::uiMedData::action::SExportSeries" autoConnect="yes">
                        <seriesId>${AS_UID}</seriesId>
                    </service>
                </object>
            </item>

            <item key="activitySeries">
                <object uid="${AS_UID}" src="ref" type="::fwMedData::ActivitySeries" />
            </item>

            <!-- GENERIC SCENE DEFINITION -->
            <item key="visuConfig">
                <object uid="${GENERIC_UID}_VisuComposite" type="::fwData::Composite">

                    <service uid="${GENERIC_UID}_ActionShowVR" impl="::gui::action::SPushObject" type="::fwGui::IActionSrv" autoConnect="yes">
                        <push src="${GENERIC_UID}_VisuComposite[imageKey]" key="image" />
                    </service>

                    <service uid="${GENERIC_UID}_ActionShowMesh" impl="::gui::action::SPushObject" type="::fwGui::IActionSrv" autoConnect="yes">
                        <push src="${ModelSeriesCompositeUid}[OptionalModelSeriesKey]" key="modelSeries" />
                    </service>

                    <service uid="${GENERIC_UID}_ActionShowSliceCursor" impl="::gui::action::SPushObject" type="::fwGui::IActionSrv" autoConnect="no">
                        <push src="${GENERIC_UID}_VisuComposite[image]" key="imageCursor" />
                    </service>

                    <service uid="${GENERIC_UID}_managerImageSeries" impl="::ctrlSelection::manager::SwapperSrv" type="::ctrlSelection::IManagerSrv" autoConnect="yes">
                        <mode type="stop" />
                        <config>
                            <object id="image" type="::fwData::Image">

                                <service uid="${GENERIC_UID}_MedicalImageSrv" impl="::ctrlSelection::MedicalImageSrv" type="::fwServices::IController" autoConnect="no" />

                                <service uid="${GENERIC_UID}_cfgNegato" type="::fwServices::IController" impl="::fwServices::SConfigController" autoConnect="no">
                                    <config>
                                        <appConfig id="2DNegatoWithTF">
                                            <parameters>
                                                <parameter replace="imageUid" by="self" />
                                                <parameter replace="orientation" by="axial" />
                                                <parameter replace="TFSelectionsUid" by="${GENERIC_UID}_TFSelections" />
                                                <parameter replace="selectedTFKey" by="SelectedTF" />
                                                <parameter replace="WID_PARENT" by="${GENERIC_UID}_view_negato" />
                                                <parameter replace="CrossTypeChannel" by="crossTypeChannel" />
                                            </parameters>
                                        </appConfig>
                                    </config>
                                </service>

                                <service uid="${GENERIC_UID}_ActionHideCross" type="::fwGui::IActionSrv" impl="::uiVisu::action::CrossTypeAction" autoConnect="no">
                                    <crossType>hide</crossType>
                                </service>

                                <service uid="${GENERIC_UID}_ActionShowNormalCross" type="::fwGui::IActionSrv" impl="::uiVisu::action::CrossTypeAction" autoConnect="no">
                                    <crossType>half</crossType>
                                    <state active="true" />
                                </service>

                                <service uid="${GENERIC_UID}_ActionShowFullCross" type="::fwGui::IActionSrv" impl="::uiVisu::action::CrossTypeAction" autoConnect="no">
                                    <crossType>full</crossType>
                                </service>

                                <service uid="${GENERIC_UID}_ActionShowHideBoxWidget" type="::fwGui::IActionSrv" impl="::gui::action::SBooleanSlotCaller" autoConnect="no">
                                    <slots>
                                        <slot>${GENERIC_UID}_VolumeScene3DA/activateBoxClipping</slot>
                                    </slots>
                                    <state active="true" />
                                </service>
    
                                <service uid="${GENERIC_UID}_ActionResetBoxWidget" type="::fwGui::IActionSrv" impl="::gui::action::SSlotCaller" autoConnect="no">
                                    <slots>
                                        <slot>${GENERIC_UID}_VolumeScene3DA/resetBoxWidget</slot>
                                    </slots>
                                </service>

                                <service uid="${GENERIC_UID}_FieldManager" impl="::ctrlSelection::manager::SField" type="::ctrlSelection::IManagerSrv" autoConnect="yes">
                                    <mode type="stop" />
                                    <config>
                                        <field id="m_transferFunctionCompositeId" type="::fwData::Composite">
                                            <service uid="${GENERIC_UID}_tfm" type="::gui::editor::IEditor" impl="::uiTF::TransferFunctionEditor" autoConnect="yes">
                                                <config selectedTFKey="SelectedTF" tfSelectionFwID="${GENERIC_UID}_TFSelections" />
                                            </service>
                                        </field>
                                    </config>
                                </service> 

                                <service uid="${GENERIC_UID}_computeHistogram" type="::fwServices::IController" impl="::scene2D::processing::SComputeHistogram"
                                    autoConnect="yes" worker="COMPUTING_THREAD" >
                                    <histogramId>${GENERIC_UID}_Histogram</histogramId>
                                    <binsWidth>5.0</binsWidth>
                                </service>

                                <proxy channel="crossTypeChannel">
                                    <signal>${GENERIC_UID}_ActionHideCross/crossTypeModified</signal>
                                    <signal>${GENERIC_UID}_ActionShowNormalCross/crossTypeModified</signal>
                                    <signal>${GENERIC_UID}_ActionShowFullCross/crossTypeModified</signal>
                                </proxy>

                            </object>
                        </config>
                    </service>

                    <service uid="${GENERIC_UID}_managerModelSeries" impl="::ctrlSelection::manager::SwapperSrv" type="::ctrlSelection::IManagerSrv" autoConnect="yes" >
                        <mode type="stop" />
                        <config>

                            <object id="modelSeries" type="::fwMedData::ModelSeries">
                                <service uid="${GENERIC_UID}_action_organManager" impl="::gui::action::SConfigLauncher" type="::fwGui::IActionSrv" autoConnect="yes">
                                   <config>
                                        <appConfig id="OrganManagerWithSeries" >
                                            <parameters>
                                                <parameter replace="ORGAN_MANAGER_MODELSERIES" by="self"  />
                                                <parameter replace="ICON_PATH" by="${ICON_PATH}"  />
                                                <parameter replace="ModelRepresentationChannel" by="ModelRepresentationChannel"  />
                                                <parameter replace="ModelDisplayChannel" by="ModelDisplayChannel" />
                                            </parameters>
                                        </appConfig>
                                    </config>
                                </service>
                            </object>
                        </config>
                    </service>

                    <service uid="${GENERIC_UID}_ActionSnapshotVR" impl="::uiVisu::action::SSnapshot" type="::fwGui::IActionSrv" autoConnect="no"/>

                    <!-- Negato1-->
                    <service uid="${GENERIC_UID}_negato1" impl="::fwRenderVTK::SRender" type="::fwRender::IRender" autoConnect="yes">
                        <scene>

                            <picker id="negatodefault" vtkclass="fwVtkCellPicker" />

                            <renderer id="default" background="0.0" />

                            <adaptor id="interactor" class="::visuVTKAdaptor::InteractorStyle" objectId="self">
                                <config renderer="default" style="InteractorStyle2DForNegato" />
                            </adaptor> 

                            <adaptor id="MPRNegato" class="::visuVTKAdaptor::NegatoMPR" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" mode="2d" slices="1" sliceIndex="axial" />
                            </adaptor>

                            <adaptor id="text" class="::visuVTKAdaptor::ImageText" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" text="" />
                            </adaptor>

                            <adaptor id="PickerInteractor" uid="${GENERIC_UID}_Picker1" class="::visuVTKAdaptor::PickerInteractor" objectId="self">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>

                            <adaptor id="PointList" class="::visuVTKAdaptor::PointList" objectId="selectedPoints">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>
                            
                            <proxy channel="interaction_channel">
                                <signal>${GENERIC_UID}_Picker1/picked</signal>
                            </proxy>

                        </scene>
                    </service>

                    <!-- Negato2 -->
                    <service uid="${GENERIC_UID}_negato2" impl="::fwRenderVTK::SRender" type="::fwRender::IRender" autoConnect="yes">
                        <scene>

                            <picker id="negatodefault" vtkclass="fwVtkCellPicker" />

                            <renderer id="default" background="0.0" />

                            <adaptor id="interactor" class="::visuVTKAdaptor::InteractorStyle" objectId="self">
                                <config renderer="default" style="InteractorStyle2DForNegato" />
                            </adaptor>

                            <adaptor id="MPRNegato" class="::visuVTKAdaptor::NegatoMPR" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" mode="2d" slices="1" sliceIndex="frontal" />
                            </adaptor>

                            <adaptor id="text" class="::visuVTKAdaptor::ImageText" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" text="" />
                            </adaptor>

                            <adaptor id="Picker" uid="${GENERIC_UID}_Picker2" class="::visuVTKAdaptor::PickerInteractor" objectId="self">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>

                            <adaptor id="PointList" class="::visuVTKAdaptor::PointList" objectId="selectedPoints">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>
                            
                            <proxy channel="interaction_channel">
                                <signal>${GENERIC_UID}_Picker2/picked</signal>
                            </proxy>

                        </scene>
                    </service>

                    <!-- Negato3 -->

                    <service uid="${GENERIC_UID}_negato3" impl="::fwRenderVTK::SRender" type="::fwRender::IRender" autoConnect="yes">
                        <scene>

                            <picker id="negatodefault" vtkclass="fwVtkCellPicker" />

                            <renderer id="default" background="0.0" />

                            <adaptor id="interactor" class="::visuVTKAdaptor::InteractorStyle" objectId="self">
                                <config renderer="default" style="InteractorStyle2DForNegato" />
                            </adaptor>

                            <adaptor id="MPRNegato" class="::visuVTKAdaptor::NegatoMPR" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" mode="2d" slices="1" sliceIndex="sagittal" />
                            </adaptor>

                            <adaptor id="text" class="::visuVTKAdaptor::ImageText" objectId="imageKey">
                                <config renderer="default" picker="negatodefault" text="" />
                            </adaptor>

                            <adaptor id="Picker" uid="${GENERIC_UID}_Picker3" class="::visuVTKAdaptor::PickerInteractor" objectId="self">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>

                            <adaptor id="PointList" class="::visuVTKAdaptor::PointList" objectId="selectedPoints">
                                <config renderer="default" picker="negatodefault" />
                            </adaptor>
                            
                            <proxy channel="interaction_channel">
                                <signal>${GENERIC_UID}_Picker3/picked</signal>
                            </proxy>

                        </scene>
                    </service>

                    <!-- Generic Scene VR -->
                    <service uid="${GENERIC_UID}_camView" impl="::fwRenderVTK::SRender" type="::fwRender::IRender" autoConnect="yes">
                        <scene>

                            <picker id="negato1default" vtkclass="fwVtkCellPicker" />

                            <renderer id="default" background="0.0" />

                            <adaptor id="snapshot1" uid="${GENERIC_UID}_snapshotUID" class="::visuVTKAdaptor::Snapshot" objectId="self">
                                <config renderer="default" />
                            </adaptor>

                            <adaptor id="Interactor1" class="::visuVTKAdaptor::InteractorStyle" objectId="self">
                                <config renderer="default" style="InteractorStyle3DForNegato" />
                            </adaptor>

                            <adaptor id="Image3DCursor" class="::visuVTKAdaptor::Image3DCursor" objectId="imageCursor">
                                <config renderer="default" />
                            </adaptor>

                            <adaptor id="modelSeriesAdaptor" uid="${GENERIC_UID}_modelSeriesAdaptorUid" class="::visuVTKAdaptor::ModelSeries" objectId="modelSeries">
                                <config renderer="default" picker="negato1default" autoresetcamera="no" />
                            </adaptor>

                            <adaptor id="VolumeScene3DA" uid="${GENERIC_UID}_VolumeScene3DA" class="::visuVTKVRAdaptor::Volume" objectId="image">
                                <config renderer="default" selectedTFKey="SelectedTF" tfSelectionFwID="${GENERIC_UID}_TFSelections" />
                            </adaptor>

                            <adaptor id="CamPosMatrix" class="::visuVTKAdaptor::Camera2" objectId="CurrentViewPoint">
                                <config renderer="default" picker="" />
                            </adaptor>
                            
                            <proxy channel="ModelRepresentationChannel" waitForKey="modelSeries">
                                <slot>${GENERIC_UID}_modelSeriesAdaptorUid/updateNormalMode</slot>
                            </proxy>
                                                                                    
                            <proxy channel="ModelDisplayChannel" waitForKey="modelSeries">
                                <slot>${GENERIC_UID}_modelSeriesAdaptorUid/showReconstructions</slot>
                            </proxy>
                            
                            <connect>
                                <signal>${GENERIC_UID}_ActionSnapshotVR/snapped</signal>
                                <slot>${GENERIC_UID}_snapshotUID/snap</slot>
                            </connect>

                        </scene>
                    </service>

                    <service uid="${GENERIC_UID}_Scene2D" impl="::scene2D::SRender" type="::fwRender::IRender" autoConnect="yes">

                        <scene>

                            <scene x="-1100" y="-1.1" width="2400" height="1.2" antialiasing="true" />

                            <viewport id="view1" x="-500" y="-1.1" width="500" height="1.2" />

                            <axis id="xAxis" origin="0.0" scale="1.0" scaleType="LINEAR" />
                            <axis id="yAxis" origin="0.0" scale="-1.0" scaleType="LINEAR" />

                            <axis id="axeHistogramY" origin="0.0" scale="-0.000001" scaleType="LINEAR" />

                            <adaptor id="grid" class="::scene2D::adaptor::Grid2D" objectId="self">
                                <config xMin="-1200" xMax="1500" yMin="0.0" yMax="1.0" xSpacing="100" ySpacing="0.1" opacity="0.25"
                                    viewportUID="${GENERIC_UID}_Viewport" color="darkGray" xAxis="xAxis" yAxis="yAxis" zValue="1" />
                            </adaptor>

                            <adaptor id="abscissa" class="::scene2D::adaptor::Line" objectId="self">
                                <config x1="-1200" x2="1500" y1="0" y2="0" color="white" xAxis="xAxis" yAxis="yAxis" zValue="2" />
                            </adaptor>

                            <adaptor id="ordinate" class="::scene2D::adaptor::Line" objectId="self">
                                <config x1="0" x2="0" y1="-0.1" y2="1.2" color="white" xAxis="xAxis" yAxis="yAxis" zValue="3" />
                            </adaptor>

                            <adaptor id="maxOpacity" class="::scene2D::adaptor::Line" objectId="self">
                                <config x1="-1200" x2="1500" y1="1" y2="1" color="red" xAxis="xAxis" yAxis="yAxis" zValue="4" />
                            </adaptor>

                            <adaptor id="curvedHistogram" class="::scene2D::adaptor::CurvedHistogram" objectId="histogram">
                                <config xAxis="xAxis" yAxis="axeHistogramY" borderColor="lightGray" innerColor="gray" opacity="0.25" zValue="6"
                                    histogramPointUID="${GENERIC_UID}_HistogramPoint" borderWidth="2.0" />
                            </adaptor>

                            <!-- A graphic cursor that follow histogram's shape according to mouse's cursor -->
                            <adaptor id="histogramCursor" class="::scene2D::adaptor::HistogramCursor" objectId="histogram">
                                <config xAxis="xAxis" yAxis="axeHistogramY" color="blue" borderColor="gray" zValue="9" pointSize="16"
                                    viewportUID="${GENERIC_UID}_Viewport" histogramPointUID="${GENERIC_UID}_HistogramPoint" />
                            </adaptor>

                            <adaptor id="histogramValue" class="::scene2D::adaptor::HistogramValue" objectId="histogram">
                                <config xAxis="xAxis" yAxis="axeHistogramY" zValue="12" fontSize="6" viewportUID="${GENERIC_UID}_Viewport"
                                    histogramPointUID="${GENERIC_UID}_HistogramPoint" />
                            </adaptor>

                            <adaptor id="tf2" class="::scene2D::adaptor::TransferFunction" objectId="image">
                                <config lineColor="lightGray" circleColor="lightGray" xAxis="xAxis" yAxis="yAxis" zValue="7" viewportUID="${GENERIC_UID}_Viewport"
                                    selectedTFKey="SelectedTF" tfSelectionFwID="${GENERIC_UID}_TFSelections" />
                            </adaptor> 

                            <adaptor id="viewportRangeUpdater" class="::scene2D::adaptor::ViewportUpdater" objectId="viewport">
                                <config xAxis="xAxis" yAxis="yAxis" zValue="9" />
                            </adaptor>

                            <adaptor id="scaleValuesLeft" class="::scene2D::adaptor::ScaleValues" objectId="self">
                                <config min="0.0" max="1.0" interval="0.1" fontSize="7" align="left" unit="%" viewportUID="${GENERIC_UID}_Viewport" color="darkGray"
                                    xAxis="xAxis" yAxis="yAxis" zValue="11" />
                            </adaptor>

                            <adaptor id="axisLeft" class="::scene2D::adaptor::Axis" objectId="self">
                                <config min="0.0" max="1.0" interval="0.1" align="left" tickSize="5" viewportUID="${GENERIC_UID}_Viewport" color="darkGray"
                                    xAxis="xAxis" yAxis="yAxis" zValue="11" />
                            </adaptor>

                            <adaptor id="scaleValuesBottom" class="::scene2D::adaptor::ScaleValues" objectId="self">
                                <config min="-1024" max="1024" interval="200" fontSize="7" align="bottom" viewportUID="${GENERIC_UID}_Viewport" color="darkGray"
                                    xAxis="xAxis" yAxis="yAxis" zValue="11" />
                            </adaptor>

                            <adaptor id="axisBottom" class="::scene2D::adaptor::Axis" objectId="self">
                                <config min="-1024" max="1024" interval="100" align="bottom" tickSize="5" viewportUID="${GENERIC_UID}_Viewport" color="darkGray"
                                    xAxis="xAxis" yAxis="yAxis" zValue="11" />
                            </adaptor>

                        </scene>

                    </service>

                    <service uid="${GENERIC_UID}_Scene2D_Shutter" impl="::scene2D::SRender" type="::fwRender::IRender" autoConnect="yes">

                        <scene>

                            <scene x="-1100" y="-1.1" width="2400" height="1.2" />

                            <viewport id="view1" x="-1100" y="-1.1" width="2400" height="1.2" />

                            <axis id="xAxis" origin="0.0" scale="1.0" scaleType="LINEAR" />
                            <axis id="yAxis" origin="0.0" scale="-1.0" scaleType="LINEAR" />

                            <axis id="axeHistogramY" origin="0.0" scale="-0.000001" scaleType="LINEAR" />

                            <adaptor id="shutterGrid" class="::scene2D::adaptor::Grid2D" objectId="self">
                                <config xMin="-1200" xMax="1400" yMin="-0.7" yMax="1.7" xSpacing="200" ySpacing="0.2" viewportUID="${GENERIC_UID}_Viewport"
                                    color="darkGray" xAxis="xAxis" yAxis="yAxis" zValue="1" />
                            </adaptor>

                            <adaptor id="shutterAbscissa" class="::scene2D::adaptor::Line" objectId="self">
                                <config x1="-1200" x2="1400" y1="0" y2="0" color="white" xAxis="xAxis" yAxis="yAxis" zValue="2" />
                            </adaptor>

                            <adaptor id="shutterOrdinate" class="::scene2D::adaptor::Line" objectId="self">
                                <config x1="0" x2="0" y1="-0.1" y2="1.2" color="white" xAxis="xAxis" yAxis="yAxis" zValue="3" />
                            </adaptor>

                            <adaptor id="shutterHistogram" class="::scene2D::adaptor::Histogram" objectId="histogram">
                                <config color="green" xAxis="xAxis" yAxis="axeHistogramY" zValue="4" />
                            </adaptor>

                            <adaptor id="viewportRangeSelector" class="::scene2D::adaptor::ViewportRangeSelector" objectId="viewport">
                                <config xAxis="xAxis" yAxis="yAxis" zValue="5" initialWidth="1200" initialPos="-700" />
                            </adaptor>

                        </scene>

                    </service>

                    <service uid="${GENERIC_UID}_translateUpdater" impl="::ctrlSelection::updater::STranslate" type="::ctrlSelection::IUpdaterSrv" autoConnect="no">
                        <source>${GENERIC_UID}_VRParam</source>
                        <translate fromKey="Lights" toKey="VisuLights" />
                    </service>

                    <service uid="${GENERIC_UID}_navigationEditor" type="::gui::editor::IEditor" impl="::uiNavigation::SNavigationEditor" autoConnect="yes">
                        <sliderLength value="100"/>
                        <timerDuration value="100"/>
                        <iterationsNumber value="200"/>
                    </service>

                    <item key="imageKey">
                        <object uid="${imageUid}" src="ref" type="::fwData::Image">

                            <service uid="${GENERIC_UID}_MedicalImageSrv2" impl="::ctrlSelection::MedicalImageSrv" type="::fwServices::IController" autoConnect="no" />
                            <service uid="${GENERIC_UID}_LockImageSrv" impl="::ctrlMemory::LockDumpSrv" type="::fwServices::IController" autoConnect="no" />

                            <service uid="${GENERIC_UID}_slider_negato1" impl="::uiImage::SliceIndexPositionEditor" type="::gui::editor::IEditor" autoConnect="yes">
                                <sliceIndex>axial</sliceIndex>
                            </service> 

                            <service uid="${GENERIC_UID}_slider_negato2" impl="::uiImage::SliceIndexPositionEditor" type="::gui::editor::IEditor" autoConnect="yes">
                                <sliceIndex>frontal</sliceIndex>
                            </service>

                            <service uid="${GENERIC_UID}_slider_negato3" impl="::uiImage::SliceIndexPositionEditor" type="::gui::editor::IEditor" autoConnect="yes">
                                <sliceIndex>sagittal</sliceIndex>
                            </service>

                            <service uid="${GENERIC_UID}_updateNegato" type="::fwServices::IController" impl="::ctrlPointSelection::SUpdateNegato" autoConnect="yes"/>

                        </object>
                    </item> 

                    <item key="TFSelectionsKey">
                        <object uid="${GENERIC_UID}_TFSelections" type="::fwData::Composite" />
                    </item>

                    <item key="CurrentViewPoint">
                        <object uid="${GENERIC_UID}_CurrentViewPoint" type="::fwData::TransformationMatrix3D">
                            <service uid="${GENERIC_UID}_SJumpToPoint" type="::fwServices::IController" impl="::ctrlSplineNavigation::SJumpToPointController" autoConnect="yes" worker="SJumpToPoint_worker"/>
                        </object>
                    </item>

                    <item key="viewport">
                        <object uid="${GENERIC_UID}_Viewport" type="::scene2D::data::Viewport" />
                    </item>

                    <item key="histogram">
                        <object uid="${GENERIC_UID}_Histogram" type="::fwData::Histogram" />
                    </item>

                    <item key="histogramPoint">
                        <object uid="${GENERIC_UID}_HistogramPoint" type="::fwData::Point" />
                    </item>

                    <item key="LightSelection">
                        <object uid="${GENERIC_UID}_LightSelection" type="::fwData::Composite">

                            <service uid="${GENERIC_UID}_LightSwapper" impl="::ctrlSelection::manager::SwapperSrv" type="::ctrlSelection::IManagerSrv" autoConnect="yes">
                                <mode type="stop" />
                                <config>
                                    <object id="selectedLight" type="::fwData::Composite">
                                    </object>
                                </config>
                            </service>

                        </object>
                    </item>

                    <item key="VRParam">
                        <object uid="${GENERIC_UID}_VRParam" type="::fwData::Composite">

                            <service uid="${GENERIC_UID}_action_exportVRParam" type="::fwGui::IActionSrv" impl="::gui::action::SStarter" autoConnect="no">
                                <start uid="${GENERIC_UID}_writerVRParam" />
                            </service>
                            <service uid="${GENERIC_UID}_writerVRParam" type="::gui::editor::IDialogEditor" impl="::uiIO::editor::SIOSelector" autoConnect="no">
                                <type mode="writer" />
                                <selection mode="include" />
                                <addSelection service="::ioXML::FwXMLGenericWriterService" />
                                <config id="FwXMLGenericWriterReaderVRConfig" service="::ioXML::FwXMLGenericWriterService" />
                            </service>

                        </object>
                    </item>

                    <item key="splinePointList">
                        <object uid="${SplinePointListUid}" src="ref" type="::fwData::PointList">
                            <service uid="${GENERIC_UID}_splinePointsEditor" type="::gui::editor::IEditor" impl="::uiSpline::SSplinePointsEditor" autoConnect="yes">
                                <points uid="${GENERIC_UID}_selectedPoints"/>
                            </service>
                            <service uid="${GENERIC_UID}_MoveAlongSpline" type="::fwServices::IController" impl="::ctrlSplineNavigation::SMoveAlongSpline" autoConnect="yes"/>
                        </object> 
                    </item>

                    <item key="selectedPoints">
                        <object uid="${GENERIC_UID}_selectedPoints" type="::fwData::PointList"/>
                    </item>

                </object>
            </item>

            <connect>
                <signal>${GENERIC_UID}_navigationEditor/sliderProgressed</signal>
                <slot>${GENERIC_UID}_MoveAlongSpline/changeSliderValue</slot>
            </connect>

            <connect>
                <signal>${GENERIC_UID}_splinePointsEditor/pointSelected</signal>
                <slot>${GENERIC_UID}_MoveAlongSpline/changeSelectedPoint</slot>
            </connect>

            <connect>
                <signal>${GENERIC_UID}_MoveAlongSpline/PointChanged</signal>
                <slot>${GENERIC_UID}_SJumpToPoint/changeDirectTarget</slot>
            </connect>

            <connect>
                <signal>${GENERIC_UID}_splinePointsEditor/pointSelected</signal>
                <slot>${GENERIC_UID}_updateNegato/selectNewPoint</slot>
            </connect>
            
            <proxy channel="interaction_channel">
                <slot>${GENERIC_UID}_splinePointsEditor/getInteraction</slot>
            </proxy>

            <!-- START AND STOP SERVICES -->
            <start uid="${GENERIC_UID}_translateUpdater" />
            <start uid="${GENERIC_UID}_mainView" />
            <start uid="${GENERIC_UID}_LightSwapper" />
            <start uid="${GENERIC_UID}_SJumpToPoint" />
            <start uid="${GENERIC_UID}_managerModelSeries" />
            <start uid="${GENERIC_UID}_managerImageSeries" />
            <start uid="${GENERIC_UID}_LockImageSrv" />
            <start uid="${GENERIC_UID}_splinePointsEditor" />
            <start uid="${GENERIC_UID}_navigationEditor" />
            <start uid="${GENERIC_UID}_MoveAlongSpline"/>
            <start uid="${GENERIC_UID}_updateNegato"/>
        </object>


    </config>
</extension>

